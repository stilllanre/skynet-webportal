server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;

	# server name matcher
	server_name *.hns.siasky.dev *.hns.dev3.siasky.dev;

	# server specific certificate string
	set_by_lua_block $cert { return string.gsub(ngx.var.server_name, "*", "wildcard_") }
	ssl_certificate     /data/caddy/caddy/certificates/acme-v02.api.letsencrypt.org-directory/$cert/$cert.crt;
	ssl_certificate_key	/data/caddy/caddy/certificates/acme-v02.api.letsencrypt.org-directory/$cert/$cert.key;

	# include common ssl settings
	include /etc/nginx/conf.d/include/ssl-settings;

	location / {
        set_by_lua $skylink 'return string.match(ngx.var.host, "(.*)\.hns")'
		set $path $uri;

		include /etc/nginx/conf.d/include/location-skylink;
	}
}
